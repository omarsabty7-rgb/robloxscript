local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local UICorner = Instance.new("UICorner")
local UIStroke = Instance.new("UIStroke")
local UIGradient = Instance.new("UIGradient")
local Title = Instance.new("TextLabel")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

-- Default Values
local AimbotEnabled, Flying, SpeedEnabled, JumpEnabled, NoclipEnabled, ESPEnabled = false, false, false, false, false, false
local WalkSpeedValue, JumpPowerValue, FlySpeedValue, SmoothnessValue = 100, 150, 100, 0.15

-- UI Setup
ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false

MainFrame.Name = "GalaxyMain"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(255, 255, 255) -- White for Gradient
MainFrame.Position = UDim2.new(0.3, 0, 0.3, 0)
MainFrame.Size = UDim2.new(0, 300, 0, 550)
MainFrame.Active = true
MainFrame.Draggable = true

-- Galaxy Gradient Effect
UIGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(15, 10, 30)), -- Deep Space
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(45, 20, 70)), -- Nebula Purple
    ColorSequenceKeypoint.new(1, Color3.fromRGB(10, 15, 40)) -- Galactic Blue
}
UIGradient.Rotation = 45
UIGradient.Parent = MainFrame

UICorner.CornerRadius = UDim.new(0, 15)
UICorner.Parent = MainFrame

-- Neon Border
UIStroke.Parent = MainFrame
UIStroke.Color = Color3.fromRGB(130, 80, 255)
UIStroke.Thickness = 2
UIStroke.Transparency = 0.3

-- Title
Title.Parent = MainFrame
Title.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Title.BackgroundTransparency = 0.8
Title.Size = UDim2.new(1, 0, 0, 45)
Title.Text = "✧ GALAXY HUB | V7 ✧"
Title.TextColor3 = Color3.fromRGB(200, 180, 255)
Title.TextSize = 18
Title.Font = Enum.Font.GothamBold

-- Smart Toggle Function
local function CreateControl(name, pos, defaultValue, callback)
    local active = false
    local btn = Instance.new("TextButton", MainFrame)
    btn.Text = name .. ": OFF"
    btn.Position = pos
    btn.Size = UDim2.new(0.6, 0, 0, 38)
    btn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    btn.BackgroundTransparency = 0.9
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 11
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
    local s = Instance.new("UIStroke", btn)
    s.Color = Color3.fromRGB(255, 255, 255)
    s.Transparency = 0.8

    local input = Instance.new("TextBox", MainFrame)
    input.Text = tostring(defaultValue)
    input.Position = UDim2.new(pos.X.Scale + 0.65, 0, pos.Y.Scale, 0)
    input.Size = UDim2.new(0.25, 0, 0, 38)
    input.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    input.BackgroundTransparency = 0.6
    input.TextColor3 = Color3.fromRGB(180, 150, 255)
    input.Font = Enum.Font.Code
    input.TextSize = 14
    Instance.new("UICorner", input)

    btn.MouseButton1Click:Connect(function()
        active = not active
        btn.Text = active and name .. ": ON" or name .. ": OFF"
        btn.TextColor3 = active and Color3.fromRGB(0, 255, 180) or Color3.fromRGB(255, 255, 255)
        s.Color = active and Color3.fromRGB(0, 255, 180) or Color3.fromRGB(255, 255, 255)
        callback("toggle", active)
    end)
    input.FocusLost:Connect(function() callback("value", tonumber(input.Text)) end)
end

-- ESP Button Logic
local function CreateESPBtn(pos)
    local btn = Instance.new("TextButton", MainFrame)
    btn.Text = "GALAXY ESP: OFF"
    btn.Position = pos
    btn.Size = UDim2.new(0.9, 0, 0, 40)
    btn.BackgroundColor3 = Color3.fromRGB(100, 50, 200)
    btn.BackgroundTransparency = 0.7
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.GothamBold
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
    
    btn.MouseButton1Click:Connect(function()
        ESPEnabled = not ESPEnabled
        btn.Text = ESPEnabled and "GALAXY ESP: ON" or "GALAXY ESP: OFF"
        btn.BackgroundColor3 = ESPEnabled and Color3.fromRGB(0, 200, 150) or Color3.fromRGB(100, 50, 200)
    end)
end

-- Runtime Loops
RunService.Stepped:Connect(function()
    for _, player in pairs(game.Players:GetPlayers()) do
        if player ~= game.Players.LocalPlayer and player.Character then
            local h = player.Character:FindFirstChild("G-ESP")
            if ESPEnabled then
                if not h then h = Instance.new("Highlight", player.Character); h.Name = "G-ESP" end
                h.FillColor = (player.Team == game.Players.LocalPlayer.Team) and Color3.fromRGB(0, 150, 255) or Color3.fromRGB(255, 0, 150)
            elseif h then h:Destroy() end
        end
    end
end)

RunService.Heartbeat:Connect(function()
    local char = game.Players.LocalPlayer.Character
    if char and char:FindFirstChild("Humanoid") then
        if SpeedEnabled then char.Humanoid.WalkSpeed = WalkSpeedValue end
        if JumpEnabled then char.Humanoid.JumpPower = JumpPowerValue char.Humanoid.UseJumpPower = true end
        if NoclipEnabled then
            for _, p in pairs(char:GetDescendants()) do if p:IsA("BasePart") then p.CanCollide = false end end
        end
    end
end)

-- Initialize Controls
CreateControl("SPEED", UDim2.new(0.05, 0, 0.12, 0), WalkSpeedValue, function(t, v) if t == "toggle" then SpeedEnabled = v else WalkSpeedValue = v end end)
CreateControl("JUMP", UDim2.new(0.05, 0, 0.22, 0), JumpPowerValue, function(t, v) if t == "toggle" then JumpEnabled = v else JumpPowerValue = v end end)
CreateControl("FLY", UDim2.new(0.05, 0, 0.32, 0), FlySpeedValue, function(t, v)
    if t == "toggle" then
        Flying = v; NoclipEnabled = v; local root = game.Players.LocalPlayer.Character.HumanoidRootPart
        if Flying then
            local bv = Instance.new("BodyVelocity", root); bv.Name = "G-Fly"; bv.MaxForce = Vector3.new(1,1,1)*math.huge
            task.spawn(function()
                while Flying do
                    local cam = workspace.CurrentCamera.CFrame; local v3 = Vector3.new(0,0,0)
                    if UserInputService:IsKeyDown("W") then v3 = v3 + cam.LookVector end
                    if UserInputService:IsKeyDown("S") then v3 = v3 - cam.LookVector end
                    if UserInputService:IsKeyDown("D") then v3 = v3 + cam.RightVector end
                    if UserInputService:IsKeyDown("A") then v3 = v3 - cam.RightVector end
                    if UserInputService:IsKeyDown("Space") then v3 = v3 + Vector3.new(0,1,0) end
                    if UserInputService:IsKeyDown("LeftShift") then v3 = v3 - Vector3.new(0,1,0) end
                    bv.Velocity = v3 * FlySpeedValue; task.wait()
                end
                bv:Destroy()
            end)
        end
    else FlySpeedValue = v end
end)
CreateControl("AIM", UDim2.new(0.05, 0, 0.42, 0), SmoothnessValue, function(t, v) if t == "toggle" then AimbotEnabled = v else SmoothnessValue = v end end)
CreateESPBtn(UDim2.new(0.05, 0, 0.52, 0))

-- Close Button
local c = Instance.new("TextButton", MainFrame)
c.Text = "EXIT GALAXY"
c.Size = UDim2.new(0.9, 0, 0, 40)
c.Position = UDim2.new(0.05, 0, 0.88, 0)
c.BackgroundColor3 = Color3.fromRGB(200, 0, 50)
c.TextColor3 = Color3.fromRGB(255, 255, 255)
c.Font = Enum.Font.GothamBold
Instance.new("UICorner", c)
c.MouseButton1Click:Connect(function() ScreenGui:Destroy() end)

-- Smooth Aimbot Loop
RunService.RenderStepped:Connect(function()
    if AimbotEnabled then
        local target = nil; local dist = 1000; local myTeam = game.Players.LocalPlayer.Team
        for _, p in pairs(game.Players:GetPlayers()) do
            if p ~= game.Players.LocalPlayer and p.Team ~= myTeam and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                local d = (p.Character.HumanoidRootPart.Position - game.Players.LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
                if d < dist then target = p; dist = d end
            end
        end
        if target then
            local cam = workspace.CurrentCamera
            cam.CFrame = cam.CFrame:Lerp(CFrame.new(cam.CFrame.Position, target.Character.HumanoidRootPart.Position), SmoothnessValue)
        end
    end
end)
